SELECT unsei_name AS unsei, ROUND(CAST(CAST(COUNT(result.omikuji_code) AS numeric) / (SELECT COUNT(omikuji_code) FROM result) * 100 AS numeric),2) as unsei_name_ratio FROM mst_unsei LEFT JOIN Omikuji  ON mst_unsei.unsei_code = Omikuji.unsei_code LEFT JOIN result ON Omikuji.omikuji_code = result.omikuji_code AND result.fortune_date >= now() - interval '6 months' GROUP BY mst_unsei.unsei_name ORDER BY unsei_name_ratio DESC
